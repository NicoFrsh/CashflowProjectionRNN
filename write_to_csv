# Write predictions and labels to csv
import numpy as np
import pandas as pd
import pickle

model_path = "grid_search_lstm_gross_surplus/Ensemble_5"

with open(model_path + "/data_johannes.pickle" , 'rb') as f:
    data = pickle.load(f)

pred_train = data["pred_train_original"]
y_train = data["y_train_original"]

pred_val = data["pred_val_original"]
y_val = data["y_val_original"]

pred_test = data["pred_test_original"]
y_test = data["y_test_original"]

# Concatenate train and validation data
pred_train = np.concatenate((pred_train, pred_val))
y_train = np.concatenate((y_train, y_val))

# Reshape arrays
pred_train = pred_train.reshape((9500,60))
y_train = y_train.reshape((9500,60))

pred_test = pred_test.reshape((501,60))
y_test = y_test.reshape((501,60))

pred_all = np.concatenate((pred_train, pred_test))
y_all = np.concatenate((y_train, y_test))


# Write to csv
pred_all_df = pd.DataFrame(pred_all)
y_all_df = pd.DataFrame(y_all)

pred_all_df.to_csv(model_path + "/predictions_rnn.csv")
y_all_df.to_csv(model_path + "/labels_aephix.csv")